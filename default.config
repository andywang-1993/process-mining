server {
        listen 80 ;
        server_name _; #for production environment replace _ with the name of your host

        error_page 301 302 @30x; # keep original HTTP status code w/o `=`
        location @30x {
         default_type ""; # will remove Content-Type completely
         # `300` is a filler: client will get the original HTTP status code
         return 300;
        }

        server_tokens off;
        return 301 https://$host$request_uri;
}

# dDOS slow-body mitigate attack
#limit_req_zone $binary_remote_addr zone=one:10m rate=30r/m;
#limit_conn_zone $binary_remote_addr zone=addr:10m;

server {
        listen   443 ssl;
        server_name _; #for production environment replace _ with the name of your host
        keepalive_timeout   70;
        server_tokens off;

        ssl on;
        ssl_certificate /etc/nginx/ssl/server.crt;
        ssl_certificate_key /etc/nginx/ssl/server.key;

                ssl_session_timeout 1d;
                ssl_session_cache shared:SSL:50m;
                ssl_session_tickets off;


                # modern configuration. tweak to your needs.
                ssl_protocols TLSv1.2;
                ssl_ciphers 'ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256';
